from typing import Optional

class ListNode:
    def __init__(self, val=0, next=None):
        self.val = val
        self.next = next


    

# 1.0) functional 

class Solution:
    def insertGreatestCommonDivisors(self, head: Optional[ListNode]) -> Optional[ListNode]:
        curr = head
        while curr and curr.next:
            div = self.getGreatestCommonDivisor(curr.val,curr.next.val)
            self.insertNode(div , curr)
            curr = curr.next.next 
        return head

    def insertNode(self, div, curr):
        new_node = ListNode(div)
        new_node.next = curr.next
        curr.next = new_node
        
    def getGreatestCommonDivisor(self, x,y):
        while y != 0:
            if x == 0:
                return y
            x, y = y % x, x

# 1.1) compressed
class Solution:
    def insertGreatestCommonDivisors(self, head: Optional[ListNode]) -> Optional[ListNode]:
        curr = head
        while curr and curr.next:
            y = curr.val
            x = curr.next.val
            while y != 0:
                if x == 0:
                    new_node = ListNode(y)
                    break
                x, y = y % x, x
            new_node.next = curr.next
            curr.next = new_node
            curr = new_node.next 
        return head

# 1.2) other attempts of optimization
class Solution:
    def insertGreatestCommonDivisors(self, head: Optional[ListNode]) -> Optional[ListNode]:
        curr = head
        while curr and curr.next:
            y = curr.val
            x = curr.next.val
            while y != 0:
                y, x = x % y, y
            new_node = ListNode(x)
            new_node.next = curr.next
            curr.next = new_node
            curr = new_node.next 
        return head

# _______________________________________________________________________________________________________________

    # AI help, so not using this
    def findGCD(self, x, y ,i=0):
        if x == 0:
            return y
        return self.findGCD(y % x, x, i)
    
    # AI help, so not using this
    def gcd(self, x, y):
        while y != 0:
            y, x = x % y, y
        return x


# class Solution:
    '''
        GCD: Greatest Common Diviser
            - Diviser: number(s) that can divide x and y evenly (remains an int)
            - Common: what divisers x and y has in common
            - Greatest: the biggest out of the common divisers 
    '''
    def insertGreatestCommonDivisors(self, head: list[int] | None) -> list[int] | None:
        '''
            1.0) 
        '''      
        i=0
        h=len(head)
        print(head)
        # while i < h+1:
        #     x = head[i]
        #     y = head[i+1]
        n = len(head)
        while i < n-1 and n>1:
            # print(f"i:{i}")
            x = head[i]
            y = head[i+1]
            gcd =  self.getGreatestCommonDivisor(x, y)
            # print(f"\n    i:{i} -> {gcd} -> {head[:i+1]}>{gcd}<{head[i+1:]}")
            head.insert(i+1, gcd)
            # print(head)
            n+=1
            i+=2
        return head
                
            # x = head[i]
            # limit = n ** 0.5
            # x_d = []


            # _i = 0 
            # while _i<x:
            #     d = limit/x
            #     print(d)
            #     x_d.append(d)
            #     _i-=1
            # print(x_d)

            # d_x = self.findAllDivisors(head[i]) 
            # d_y = self.findAllDivisors(head[i+1])
            # print(f" for y: {y}: {d_y}")
            # print(f" for x: {x}:  {d_x}")
        #     for a,b in zip(d_x, d_y):
            # print(f"{common_divisors} -[max]-> {max(common_divisors)}")
            


        # return None

    def findGreatestCommonDivisor(self, x,y):
        '''
        y | ( 6): [1, 2, 3, 6]
        x | (18): [1, 2, 3, 6, 9, 18]
        '''
        common_divisors = []
        for i in range(1, x + 1):
            if x % i == 0 and y % i == 0:
                common_divisors.append(i)
        return max(common_divisors)

    def findGreatestCommonDivisor(self, x,y):
        '''
        y | ( 6): [1, 2, 3, 6]
        x | (18): [1, 2, 3, 6, 9, 18]
        '''
        common_divisors = []
        for i in range(1, x + 1):
            print(f"\n    {i} : {x}%{i}={x % i} == 0 and {y}%{i}={y % i} == 0 | --> {x % i == 0 and y % i == 0}")
            if x % i == 0 and y % i == 0:
                common_divisors.append(i)
        return max(common_divisors)

    def findAllDivisors(seld, num):
        divisors = []
        for i in range(1, num + 1):
            if num % i == 0:
                divisors.append(i)
        return divisors

    # def insertGreatestCommonDivisors(self, head: list[int] | None) -> list[int] | None:
    def insertGreatestCommonDivisors(self, head: Optional[ListNode]) -> Optional[ListNode]:
        
        '''
            1.0) 
        '''

        # curr = head
        # _next = curr.next
        # div = 0 
        # while curr and _next:
        #     print(curr.val)
        #     div = self.getGreatestCommonDivisor(curr.val, _next.val)
        #     self.insertNode(div, curr)
        #     curr = curr.next.next
        #     # _next = curr.next

        curr = head
        while curr and curr.next:
            div = self.getGreatestCommonDivisor(curr.val, curr.next.val)
            self.insertNode(div, curr)
            curr = curr.next.next 
        # print("_____")
        # curr = head
        # while curr:
        #     print(curr.val)
        #     curr=curr.next 
        return head


    def insertNode(self, div, curr):
        new_node = ListNode(div)
        new_node.next = curr.next
        curr.next = new_node

    # def insertNode(self, div, prev, curr):
    #     new_node = ListNode(div)
    #     new_node.next = prev.next
    #     curr.next = new_node

        # i=0
        # n = len(head)
        # while i < n-1 and n>1:
        #     x = head[i]
        #     y = head[i+1]
        #     gcd =  self.getGreatestCommonDivisor(x, y)
        #     head.insert(i+1, gcd)
        #     n+=1
        #     i+=2
        # return head
                

    def getGreatestCommonDivisor(self, x,y):
        for i in range(x, 0, -1):
            if x % i == 0 and y % i == 0:
                return i

class Solution:
    def insertGreatestCommonDivisors(self, head: Optional[ListNode]) -> Optional[ListNode]:
        curr = head
        while curr and curr.next:
            y = curr.val
            x = curr.next.val
            while y != 0:
                y, x = x % y, y
            new_node = ListNode(x)
            new_node.next = curr.next
            curr.next = new_node
            curr = new_node.next 
        return head

'''___ MAIN _______________________________________________________________________________________________________________'''

def build_linked_list(values: list[int]) -> Optional[ListNode]:
    dummy = ListNode()
    tail = dummy
    for v in values:
        tail.next = ListNode(v)
        tail = tail.next
    return dummy.next

if __name__ == '__main__':

    cases = [
        [18, 6, 10, 3],
        [7],
        [1000, 999, 2],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [2, 4, 8, 16, 32],
        [3, 6, 9, 12, 15],
        [595, 642, 455, 609, 200, 367, 161, 227, 854, 872],
        [749, 613, 855, 109, 402, 915, 276, 384, 82, 487, 469, 254, 793, 74, 923, 646, 847, 255, 232, 272, 913, 461, 975, 612, 194, 841, 409, 651, 698, 854, 992, 140, 83, 710, 682, 803, 22, 716, 502, 861, 552, 406, 799, 960, 105, 1000, 848, 906, 132, 401, 735, 365, 471, 90, 298, 272, 28, 888, 933, 363, 870, 530, 407, 373, 848, 65, 665, 427, 586, 77, 570, 562, 384, 889, 781, 306, 906, 52, 293, 189, 179, 448, 41, 452, 27, 29, 631, 191, 723, 836, 522, 979, 53, 269, 211, 583, 119, 882, 188, 456, 648, 47, 953, 686, 517, 398, 149, 203, 457, 409, 491, 285, 206, 91, 950, 326, 331, 897, 228, 114, 245, 218, 950, 703, 566, 772, 554, 216, 260, 550, 24, 342, 600, 933, 117, 227, 719, 769, 88, 434, 140, 584, 587, 84, 184, 68, 219, 143, 430, 163, 429, 410, 239, 569, 117, 742, 643, 489, 402, 167, 726, 682, 950, 159, 857, 191, 591, 665, 301, 724, 357, 321, 799, 420, 889, 874, 315, 485, 411, 43, 981, 91, 78, 1000, 697, 862, 925, 155, 966, 320, 450, 877, 153, 404, 723, 620, 970, 332, 254, 87, 737, 622, 562, 579, 861, 779, 601, 261, 398, 298, 369, 625, 754, 949, 936, 275, 118, 909, 638, 351, 606, 158, 53, 171, 258, 901, 194, 676, 943, 347, 787, 824, 416, 614, 494, 588, 106, 119, 716, 39, 168, 224, 180, 879, 580, 870, 728, 485, 151, 626, 476, 328, 793, 872, 172, 714, 505, 311, 419, 679, 577, 108, 214, 451, 734, 375, 936, 314, 111, 805, 176, 745, 879, 644, 56, 414, 179, 750, 581, 496, 149, 922, 702, 179, 362, 112, 423, 653, 368, 345, 474, 677, 591, 517, 593, 681, 668, 177, 269, 93, 811, 968, 800, 555, 38, 335, 983, 788, 855, 7, 33, 99, 657, 403, 844, 897, 838, 229, 717, 681, 183, 437, 60, 625, 567, 408, 181, 997, 317, 274, 377, 499, 494, 748, 68, 157, 151, 582, 679, 2, 274, 239, 274, 260, 573, 392, 293, 843, 769, 133, 143, 674, 150, 112, 236, 359, 130, 420, 479, 278, 956, 594, 375, 799, 257, 899, 763, 599, 877, 804, 888, 952, 134, 460, 296, 802, 528, 559, 432, 532, 670, 385, 207, 219, 203, 624, 3, 762, 469, 743, 977, 386, 284, 890, 329, 638, 626, 868, 677, 297, 709, 145, 883, 690, 333, 747, 683, 695, 282, 737, 32, 473, 458, 102, 64, 264, 150, 105, 826, 192, 418, 945, 830, 579, 877, 289, 239, 997, 137, 457, 695, 20, 386, 355, 745, 843, 118, 335, 337, 523, 444, 748, 482, 845, 862, 940, 315, 557, 944, 731, 32, 603, 680, 797, 673, 816, 178, 151, 791, 726, 787, 566, 167, 927, 361, 702, 500, 996, 431, 647, 994, 384, 595, 90, 77, 687, 168, 804, 658, 757, 355, 447, 896, 48, 379, 155, 23, 986, 249, 382, 948, 856, 772, 779, 791, 234, 974, 161, 333, 805, 273, 165, 983, 796, 852, 252, 293, 662, 863, 292, 104, 949, 206, 899, 829, 61, 929, 700, 785, 490, 485, 789, 400, 421, 970, 901, 109, 72, 131, 544, 243, 26, 8, 612, 507, 146, 542, 4, 258, 317, 394, 236, 5, 245, 125, 409, 92, 452, 22, 653, 118, 102, 949, 791, 382, 951, 169, 822, 903, 505, 302, 118, 986, 543, 572, 974, 779, 870, 176, 358, 353, 670, 850, 771, 761, 299, 919, 897, 731, 883, 657, 342, 672, 591, 41, 346, 731, 498, 226, 284, 993, 44, 875, 994, 349, 97, 671, 180, 612, 23, 537, 447, 521, 679, 764, 804, 468, 578, 85, 696, 145, 113, 687, 433, 819, 171, 477, 935, 355, 994, 58, 77, 892, 860, 121, 421, 143, 965, 997, 668, 861, 919, 41, 866, 489, 389, 165, 416, 963, 951, 198, 646, 462, 674, 251, 73, 80, 810, 489, 717, 709, 444, 274, 545, 365, 690, 367, 275, 504, 172, 457, 965, 669, 946, 962, 582, 949, 374, 916, 817, 33, 966, 675, 409, 965, 588, 32, 28, 613, 518, 140, 226, 699, 378, 464, 863, 185, 84, 135, 581, 826, 440, 143, 7, 140, 205, 828, 158, 222, 983, 21, 440, 561, 448, 209, 492, 535, 47, 697, 248, 423, 903, 903, 588, 488, 506, 669, 960, 253, 337, 494, 331, 226, 793, 264, 1000, 146, 988, 698, 387, 335, 413, 437, 933, 728, 656, 962, 972, 323, 826, 165, 543, 474, 768, 899, 334, 445, 672, 893, 883, 234, 673, 389, 88, 567, 17, 885, 458, 434, 292, 435, 396, 244, 432, 782, 54, 857, 463, 445, 516, 995, 866, 803, 753, 249, 631, 385, 958, 824, 275, 421, 52, 6, 270, 845, 264, 102, 861, 881, 796, 109, 854, 284, 136, 39, 745, 809, 783, 29, 795, 103, 122, 595, 716, 534, 296, 420, 928, 589, 91, 288, 733, 944, 204, 165, 593, 134, 123, 855, 562, 997, 941, 255, 185, 766, 56, 494, 781, 219, 445, 298, 168, 755, 607, 768, 481, 708, 196, 70, 499, 806, 183, 615, 111, 76, 848, 544, 526, 947, 949, 634, 138, 893, 415, 667, 82, 713, 549, 784, 131, 761, 133, 265, 738, 287, 760, 330, 990, 844, 808, 595, 213, 116, 444, 503, 809, 823, 459, 439, 287, 646, 50, 244, 985, 802, 148, 338, 613, 480, 11, 750, 660, 528, 609, 797, 497, 312, 793, 639, 845, 494, 499, 970, 603, 57, 679, 411, 659, 270, 240, 967, 780, 502, 615, 737, 606, 323, 453, 527, 975, 948, 733, 372, 739, 445, 58, 145, 331, 570, 129, 256, 954, 283, 709, 486, 372, 992, 412, 446, 255, 707, 32, 968, 950, 932, 270, 628, 223, 572, 133, 210, 4, 817, 198, 157, 831, 886, 707, 44, 929, 381, 471, 883, 74, 332, 991, 28, 665, 243, 814, 697, 866, 26, 911, 588, 628, 861, 563, 493, 469, 44, 945, 779, 792, 125, 856, 480, 529, 226, 199, 693, 135, 96, 431, 610, 467, 113, 148, 987, 771, 801, 112, 259, 298, 688, 793, 162, 546, 519, 940, 951, 74, 957, 223, 816, 410, 41, 844, 649, 731, 459, 63, 975, 236, 164, 461, 600, 511, 279, 136, 734, 67, 874, 617, 977, 114, 363, 18, 171, 339, 689, 741, 435, 264, 633, 495, 795, 855, 18, 317, 680, 790, 484, 701, 379, 261, 138, 708, 31, 424, 659, 604, 974, 300, 276, 452, 135, 627, 350, 665, 576, 639, 595, 787, 327, 898, 746, 324, 725, 407, 61, 384, 362, 653, 690, 408, 881, 874, 58, 898, 799, 837, 569, 433, 749, 641, 216, 477, 792, 562, 408, 923, 46, 349, 499, 113, 727, 606, 427, 523, 947, 411, 239, 423, 4, 729, 382, 267, 723, 620, 976, 381, 185, 361, 829, 208, 716, 68, 618, 310, 859, 700, 743, 142, 291, 990, 665, 686, 695, 595, 125, 254, 125, 270, 380, 813, 650, 509, 997, 83, 325, 431, 459, 354, 125, 605, 269, 309, 293, 431, 196, 222, 598, 337, 110, 74, 424, 202, 479, 998, 92, 408, 166, 727, 588, 343, 329, 564, 699, 313, 62, 643, 568, 493, 93, 104, 45, 702, 220, 891, 155, 17, 828, 76, 30, 235, 995, 762, 311, 360, 842, 783, 75, 210, 818, 319, 563, 902, 671, 829, 960, 877, 607, 547, 582, 471, 387, 673, 730, 936, 550, 536, 890, 575, 733, 229, 690, 100, 591, 131, 816, 270, 780, 378, 37, 681, 452, 409, 852, 195, 214, 516, 612, 495, 405, 548, 344, 959, 937, 842, 84, 952, 78, 881, 740, 339, 896, 476, 737, 232, 435, 106, 846, 644, 138, 68, 261, 439, 350, 435, 849, 966, 1000, 387, 631, 743, 550, 992, 869, 888, 975, 164, 210, 318, 138, 125, 214, 658, 490, 777, 980, 929, 705, 771, 56, 875, 93, 867, 791, 900, 971, 469, 272, 376, 182, 178, 591, 89, 85, 572, 946, 910, 529, 888, 309, 719, 956, 290, 692, 816, 909, 646, 32, 737, 691, 295, 667, 726, 741, 806, 776, 458, 438, 163, 150, 545, 593, 557, 815, 562, 935, 630, 935, 395, 534, 96, 107, 395, 883, 318, 107, 624, 406, 481, 641, 735, 932, 999, 769, 110, 633, 705, 327, 973, 947, 694, 721, 396, 557, 291, 869, 376, 694, 589, 599, 291, 304, 56, 277, 731, 423, 949, 888, 872, 797, 483, 844, 222, 881, 809, 289, 365, 21, 309, 610, 480, 624, 409, 338, 693, 320, 825, 552, 434, 855, 960, 93, 900, 804, 626, 241, 642, 819, 678, 424, 42, 245, 501, 182, 91, 200, 26, 507, 357, 798, 490, 715, 422, 377, 315, 342, 926, 762, 240, 827, 176, 899, 532, 744, 766, 285, 806, 179, 216, 236, 166, 402, 229, 816, 381, 500, 119, 64, 825, 520, 143, 708, 376, 563, 426, 86, 151, 144, 830, 982, 547, 800, 751, 450, 900, 464, 271, 437, 950, 784, 252, 622, 789, 642, 733, 631, 486, 570, 434, 218, 157, 304, 427, 205, 290, 93, 228, 547, 839, 755, 752, 556, 589, 63, 132, 668, 176, 274, 314, 934, 259, 684, 429, 570, 823, 580, 828, 745, 735, 602, 806, 337, 208, 430, 517, 777, 891, 495, 718, 437, 604, 494, 975, 502, 856, 560, 840, 274, 798, 44, 200, 889, 306, 16, 143, 108, 879, 572, 419, 589, 993, 360, 491, 905, 734, 422, 377, 689, 444, 704, 501, 462, 619, 527, 963, 137, 589, 423, 107, 49, 962, 580, 514, 455, 346, 214, 627, 380, 458, 265, 134, 861, 586, 297, 64, 334, 61, 292, 288, 259, 87, 504, 960, 68, 179, 311, 942, 370, 906, 951, 924, 450, 928, 937, 701, 606, 118, 416, 137, 583, 936, 380, 635, 799, 201, 116, 51, 99, 610, 444, 430, 349, 595, 437, 918, 262, 828, 501, 921, 361, 899, 590, 401, 545, 28, 258, 980, 250, 223, 485, 454, 576, 988, 99, 489, 251, 257, 375, 655, 854, 362, 800, 606, 285, 897, 881, 720, 440, 634, 602, 892, 281, 225, 405, 474, 424, 854, 313, 80, 965, 516, 670, 445, 196, 928, 670, 638, 487, 135, 724, 991, 695, 361, 860, 942, 194, 849, 569, 943, 88, 431, 791, 247, 931, 387, 58, 437, 461, 665, 669, 256, 42, 90, 302, 784, 12, 932, 91, 820, 374, 633, 772, 136, 426, 212, 747, 496, 986, 564, 972, 58, 857, 70, 411, 18, 981, 607, 584, 1000, 764, 377, 990, 151, 222, 247, 902, 289, 433, 385, 75, 181, 54, 411, 967, 752, 562, 741, 959, 51, 569, 748, 433, 501, 275, 426, 39, 724, 654, 739, 824, 744, 895, 190, 505, 911, 730, 965, 950, 521, 176, 994, 414, 39, 888, 456, 129, 881, 434, 50, 680, 939, 885, 668, 366, 682, 987, 424, 756, 860, 691, 195, 987, 584, 991, 516, 189, 249, 653, 393, 760, 768, 407, 541, 516, 650, 139, 204, 756, 732, 671, 880, 29, 16, 940, 312, 931, 675, 682, 97, 857, 215, 810, 541, 548, 763, 786, 433, 622, 373, 14, 559, 671, 659, 551, 171, 589, 262, 898, 624, 522, 167, 965, 762, 909, 728, 721, 413, 538, 357, 309, 861, 93, 447, 742, 590, 336, 444, 204, 639, 400, 406, 122, 999, 813, 253, 598, 473, 410, 769, 181, 685, 54, 13, 114, 288, 132, 566, 476, 78, 541, 599, 237, 835, 61, 454, 54, 566, 526, 207, 719, 315, 398, 567, 308, 975, 801, 764, 962, 162, 611, 357, 386, 967, 666, 743, 403, 478, 901, 783, 962, 380, 359, 566, 209, 626, 470, 46, 588, 630, 1000, 171, 77, 833, 775, 456, 69, 931, 618, 375, 189, 468, 628, 625, 608, 377, 163, 979, 623, 737, 205, 957, 617, 192, 215, 302, 594, 661, 817, 840, 866, 697, 159, 605, 151, 402, 902, 718, 124, 479, 777, 441, 410, 32, 113, 909, 217, 933, 512, 560, 71, 806, 114, 944, 240, 651, 779, 832, 245, 530, 433, 280, 275, 858, 334, 599, 575, 412, 781, 713, 387, 421, 198, 26, 854, 214, 571, 198, 943, 114, 102, 122, 822, 117, 165, 423, 935, 173, 965, 70, 515, 700, 767, 106, 126, 994, 345, 215, 650, 141, 277, 894, 629, 15, 661, 584, 17, 232, 391, 432, 889, 505, 606, 17, 382, 116, 349, 729, 383, 801, 820, 580, 745, 588, 401, 116, 82, 861, 477, 733, 547, 476, 467, 919, 822, 840, 829, 565, 59, 412, 801, 412, 769, 469, 807, 98, 736, 18, 30, 78, 444, 213, 597, 233, 282, 256, 29, 441, 81, 197, 514, 171, 836, 872, 127, 351, 876, 175, 442, 396, 63, 602, 978, 694, 495, 177, 804, 878, 794, 301, 53, 551, 114, 823, 175, 621, 372, 492, 580, 698, 527, 254, 523, 615, 272, 530, 773, 917, 73, 254, 42, 509, 254, 859, 357, 445, 407, 614, 557, 417, 961, 733, 73, 53, 759, 41, 601, 595, 485, 772, 840, 985, 615, 384, 973, 148, 611, 88, 757, 621, 40, 103, 403, 943, 246, 620, 249, 356, 476, 569, 240, 949, 959, 46, 658, 959, 786, 181, 618, 751, 614, 864, 717, 637, 799, 246, 831, 329, 786, 14, 241, 682, 100, 132, 636, 459, 639, 529, 951, 199, 725, 363, 788, 592, 944, 935, 661, 445, 77, 139, 698, 139, 338, 453, 941, 616, 945, 117, 192, 898, 407, 190, 66, 55, 749, 926, 83, 699, 335, 440, 9, 235, 117, 946, 637, 43, 681, 786, 661, 597, 352, 377, 367, 699, 354, 220, 379, 929, 817, 850, 436, 69, 378, 133, 659, 755, 903, 835, 996, 797, 396, 630, 276, 527, 97, 216, 259, 715, 437, 799, 631, 21, 697, 779, 260, 106, 686, 608, 982, 713, 170, 19, 209, 58, 875, 639, 367, 322, 641, 355, 142, 64, 240, 797, 667, 637, 945, 537, 821, 785, 52, 541, 129, 457, 476, 984, 668, 905, 367, 462, 441, 106, 637, 61, 9, 983, 377, 721, 952, 672, 836, 459, 614, 544, 317, 550, 512, 844, 714, 387, 953, 759, 668, 85, 32, 175, 232, 800, 956, 831, 104, 509, 500, 550, 395, 551, 738, 657, 125, 971, 623, 408, 776, 576, 249, 77, 870, 945, 329, 441, 944, 856, 179, 192, 176, 1000, 382, 387, 479, 649, 836, 523, 847, 938, 692, 509, 478, 988, 907, 871, 881, 715, 242, 826, 615, 469, 785, 94, 855, 982, 930, 61, 615, 327, 778, 147, 734, 651, 108, 762, 884, 230, 83, 426, 468, 943, 908, 72, 17, 245, 919, 160, 858, 151, 26, 677, 75, 953, 719, 333, 193, 475, 441, 343, 450, 942, 421, 383, 211, 801, 147, 22, 361, 208, 796, 729, 96, 512, 685, 390, 202, 920, 360, 833, 993, 322, 731, 276, 449, 684, 749, 932, 879, 873, 379, 487, 69, 994, 607, 276, 448, 619, 15, 584, 663, 732, 474, 422, 991, 102, 875, 219, 416, 696, 510, 994, 725, 508, 729, 603, 557, 437, 247, 180, 650, 474, 84, 28, 703, 666, 889, 426, 587, 258, 523, 112, 223, 791, 497, 799, 157, 481, 462, 605, 280, 526, 80, 995, 762, 920, 467, 678, 561, 694, 191, 241, 573, 361, 801, 760, 428, 109, 823, 316, 547, 921, 446, 677, 221, 562, 33, 228, 697, 549, 774, 299, 871, 94, 822, 1000, 112, 11, 643, 411, 482, 187, 449, 186, 66, 428, 858, 225, 141, 50, 811, 827, 348, 525, 140, 79, 790, 926, 393, 628, 30, 359, 677, 568, 222, 415, 203, 553, 461, 373, 130, 258, 259, 700, 67, 505, 145, 732, 418, 390, 827, 478, 264, 597, 381, 96, 582, 393, 877, 17, 174, 406, 690, 284, 700, 909, 77, 904, 646, 364, 282, 973, 725, 876, 155, 353, 926, 564, 531, 552, 14, 203, 727, 508, 354, 164, 696, 831, 509, 119, 939, 397, 658, 33, 769, 871, 940, 242, 258, 730, 657, 57, 252, 445, 266, 132, 488, 522, 229, 211, 4, 729, 615, 722, 575, 230, 192, 627, 194, 261, 470, 525, 477, 122, 752, 903, 855, 419, 206, 921, 789, 562, 147, 216, 876, 593, 833, 246, 678, 470, 315, 322, 48, 689, 660, 661, 961, 308, 757, 23, 184, 783, 221, 690, 799, 194, 437, 455, 415, 197, 635, 217, 787, 93, 766, 971, 141, 434, 483, 150, 798, 840, 789, 326, 86, 275, 307, 207, 215, 996, 955, 212, 984, 220, 35, 806, 608, 826, 992, 138, 184, 769, 19, 151, 536, 39, 512, 784, 622, 286, 357, 625, 848, 695, 641, 269, 799, 752, 565, 774, 358, 469, 103, 85, 865, 398, 334, 643, 504, 844, 842, 534, 474, 917, 692, 622, 936, 965, 507, 388, 856, 994, 523, 594, 94, 937, 230, 429, 950, 582, 477, 199, 649, 528, 865, 498, 695, 428, 538, 846, 264, 186, 292, 776, 154, 135, 448, 329, 554, 739, 369, 181, 25, 306, 880, 700, 353, 255, 366, 564, 735, 824, 281, 895, 201, 167, 327, 261, 801, 817, 2, 759, 450, 525, 879, 447, 704, 19, 136, 983, 501, 926, 25, 976, 305, 726, 581, 795, 372, 121, 425, 710, 3, 744, 186, 137, 650, 53, 502, 350, 146, 46, 894, 520, 23, 838, 314, 211, 266, 696, 5, 576, 6, 462, 374, 353, 950, 108, 687, 517, 87, 33, 809, 731, 52, 12, 365, 647, 816, 153, 317, 412, 278, 412, 479, 346, 503, 925, 875, 85, 44, 172, 493, 867, 860, 105, 898, 317, 863, 72, 973, 676, 388, 195, 38, 424, 477, 167, 717, 272, 977, 261, 812, 843, 655, 295, 784, 258, 757, 985, 406, 399, 917, 65, 690, 539, 969, 776, 516, 26, 262, 546, 159, 411, 916, 553, 98, 646, 529, 978, 869, 216, 921, 131, 135, 206, 265, 176, 196, 749, 889, 972, 549, 556, 954, 146, 139, 831, 795, 88, 410, 342, 873, 548, 18, 451, 88, 250, 752, 927, 989, 153, 269, 32, 805, 219, 731, 583, 417, 916, 646, 765, 19, 299, 237, 613, 330, 252, 952, 708, 71, 568, 118, 138, 245, 419, 532, 771, 703, 350, 256, 529, 596, 952, 743, 47, 685, 703, 154, 918, 207, 709, 438, 18, 982, 688, 909, 968, 451, 999, 608, 887, 524, 952, 42, 138, 215, 363, 159, 692, 665, 336, 535, 608, 847, 648, 524, 109, 922, 943, 17, 825, 711, 28, 568, 237, 877, 487, 376, 348, 783, 587, 412, 151, 565, 790, 669, 513, 418, 8, 190, 757, 163, 17, 871, 812, 455, 168, 538, 56, 969, 734, 420, 556, 569, 536, 847, 961, 134, 211, 888, 97, 996, 513, 777, 523, 455, 123, 122, 193, 838, 828, 815, 531, 197, 661, 584, 691, 545, 146, 366, 89, 572, 941, 258, 914, 305, 541, 300, 230, 750, 305, 466, 50, 634, 584, 464, 88, 114, 442, 597, 447, 936, 923, 905, 734, 584, 788, 432, 385, 967, 180, 880, 761, 143, 708, 412, 216, 347, 231, 510, 416, 994, 70, 120, 191, 58, 63, 697, 655, 527, 49, 154, 348, 297, 255, 573, 211, 435, 837, 114, 457, 266, 93, 591, 253, 653, 943, 422, 894, 513, 980, 283, 374, 79, 625, 954, 165, 940, 651, 892, 178, 199, 283, 781, 41, 659, 591, 708, 877, 713, 960, 442, 446, 551, 120, 523, 770, 523, 490, 253, 224, 228, 703, 697, 91, 749, 177, 71, 536, 11, 398, 5, 995, 736, 104, 309, 587, 542, 697, 70, 476, 531, 475, 388, 565, 497, 210, 793, 615, 679, 431, 835, 846, 665, 365, 393, 416, 804, 360, 34, 453, 653, 781, 119, 305, 21, 156, 678, 366, 668, 438, 924, 156, 408, 838, 291, 232, 352, 333, 171, 176, 530, 30, 103, 623, 322, 585, 899, 931, 408, 72, 607, 287, 35, 454, 405, 979, 754, 364, 272, 960, 680, 881, 255, 357, 72, 58, 173, 907, 406, 59, 964, 189, 326, 797, 905, 259, 853, 706, 693, 843, 354, 170, 670, 246, 898, 121, 236, 596, 340, 347, 252, 762, 760, 797, 925, 3, 355, 558, 774, 183, 996, 925, 219, 279, 837, 565, 71, 144, 631, 581, 474, 508, 510, 483, 795, 661, 608, 805, 181, 40, 448, 543, 591, 365, 348, 33, 797, 699, 327, 297, 237, 958, 632, 567, 486, 175, 367, 672, 989, 971, 803, 656, 376, 535, 14, 436, 107, 724, 2, 828, 367, 475, 592, 739, 701, 749, 629, 631, 785, 271, 558, 443, 966, 620, 129, 846, 167, 194, 605, 517, 351, 93, 244, 863, 58, 421, 201, 948, 284, 973, 826, 85, 900, 772, 133, 218, 428, 455, 193, 415, 559, 246, 957, 542, 807, 202, 894, 158, 69, 783, 940, 56, 141, 157, 923, 485, 139, 987, 197, 876, 763, 479, 823, 606, 328, 779, 748, 215, 568, 612, 425, 990, 373, 591, 89, 369, 778, 560, 520, 126, 872, 707, 651, 748, 66, 299, 753, 504, 125, 66, 689, 888, 263, 898, 121, 653, 994, 404, 236, 467, 837, 363, 420, 990, 613, 354, 182, 563, 701, 180, 634, 988, 81, 495, 174, 411, 183, 834, 125, 511, 874, 842, 944, 74, 449, 333, 622, 482, 312, 868, 166, 982, 385, 127, 495, 452, 619, 704, 763, 744, 591, 771, 549, 120, 187, 856, 468, 559, 11, 92, 797, 659, 364, 101, 797, 627, 222, 155, 466, 823, 635, 986, 347, 505, 376, 893, 691, 795, 543, 705, 416, 63, 552, 423, 606, 620, 727, 371, 532, 87, 127, 999, 700, 778, 32, 413, 415, 103, 692, 287, 107, 778, 614, 387, 138, 111, 959, 161, 903, 555, 122, 389, 805, 379, 822, 342, 391, 845, 591, 470, 478, 889, 242, 141, 549, 908, 825, 540, 851, 924, 523, 602, 141, 156, 293, 664, 68, 806, 340, 512, 116, 134, 274, 210, 86, 168, 157, 79, 695, 809, 670, 19, 353, 625, 877, 568, 304, 159, 574, 555, 424, 613, 729, 280, 88, 107, 802, 401, 119, 292, 151, 36, 27, 424, 41, 171, 345, 183, 166, 862, 169, 2, 471, 679, 930, 719, 824, 599, 489, 104, 262, 330, 869, 482, 921, 861, 890, 887, 160, 452, 208, 411, 661, 941, 70, 714, 13, 819, 500, 904, 997, 463, 235, 303, 669, 409, 983, 261, 757, 595, 388, 113, 689, 113, 950, 904, 709, 251, 659, 385, 360, 15, 245, 756, 213, 103, 189, 129, 512, 900, 278, 227, 947, 622, 681, 3, 177, 571, 791, 235, 186, 662, 209, 724, 938, 965, 594, 463, 301, 938, 125, 943, 23, 799, 358, 948, 501, 398, 784, 146, 817, 630, 659, 981, 520, 82, 881, 684, 29, 11, 759, 101, 73, 927, 234, 391, 201, 671, 754, 977, 449, 88, 786, 982, 613, 907, 58, 18, 247, 558, 170, 13, 516, 78, 187, 75, 125, 486, 15, 664, 257, 938, 810, 917, 945, 338, 875, 209, 764, 746, 41, 698, 580, 266, 463, 584, 796, 727, 170, 160, 843, 344, 4, 840, 333, 835, 679, 918, 360, 394, 877, 320, 119, 779, 895, 229, 979, 616, 143, 344, 584, 165, 253, 965, 440, 484, 833, 19, 970, 478, 847, 213, 442, 269, 306, 450, 942, 124, 714, 469, 713, 362, 702, 732, 212, 976, 420, 433, 352, 379, 909, 158, 697, 575, 512, 523, 163, 434, 312, 966, 844, 422, 127, 394, 642, 96, 3, 923, 355, 994, 250, 357, 950, 658, 679, 129, 359, 251, 683, 852, 376, 458, 320, 344, 299, 827, 493, 503, 780, 129, 322, 614, 785, 366, 402, 68, 386, 371, 472, 770, 410, 608, 905, 935, 357, 517, 838, 285, 789, 316, 462, 12, 398, 756, 316, 458, 487, 555, 803, 745, 242, 551, 884, 768, 930, 618, 725, 32, 135, 911, 74, 827, 834, 448, 217, 290, 810, 212, 948, 18, 283, 625, 712, 307, 205, 320, 181, 709, 389, 78, 500, 384, 534, 539, 214, 921, 859, 957, 303, 508, 394, 42, 717, 587, 515, 670, 752, 287, 329, 730, 662, 74, 658, 212, 306, 491, 308, 241, 434, 215, 539, 969, 326, 203, 799, 260, 464, 535, 556, 332, 6, 869, 412, 40, 373, 31, 293, 276, 404, 78, 845, 844, 308, 869, 449, 896, 444, 714, 955, 251, 261, 213, 739, 349, 528, 877, 676, 796, 234, 269, 697, 892, 279, 55, 162, 413, 853, 473, 537, 350, 110, 931, 135, 586, 215, 99, 580, 592, 183, 337, 344, 981, 11, 726, 695, 37, 302, 467, 8, 653, 786, 932, 604, 525, 850, 211, 762, 764, 846, 83, 516, 381, 562, 310, 363, 397, 872, 176, 760, 324, 528, 38, 826, 21, 654, 481, 638, 901, 56, 79, 619, 833, 949, 491, 720, 813, 617, 329, 935, 214, 506, 7, 958, 659, 74, 738, 695, 772, 816, 379, 992, 605, 769, 622, 549, 418, 676, 199, 281, 510, 45, 776, 762, 401, 976, 675, 931, 401, 104, 912, 808, 553, 766, 183, 161, 89, 639, 85, 785, 12, 409, 65, 997, 283, 408, 708, 223, 715, 803, 531, 676, 504, 271, 4, 728, 195, 720, 405, 592, 1, 640, 587, 224, 150, 742, 511, 98, 704, 597, 156, 262, 510, 24, 21, 342, 212, 311, 698, 231, 880, 443, 790, 657, 120, 92, 973, 472, 710, 682, 92, 516, 567, 109, 988, 144, 405, 481, 182, 546, 784, 938, 83, 12, 20, 585, 806, 33, 310, 910, 585, 685, 5, 861, 175, 395, 637, 557, 524, 203, 641, 736, 52, 768, 719, 56, 37, 104, 52, 374, 72, 256, 882, 950, 350, 346, 273, 238, 144, 280, 281, 698, 973, 970, 771, 247, 451, 508, 180, 690, 237, 686, 867, 339, 952, 587, 6, 802, 940, 636, 613, 539, 521, 343, 937, 520, 50, 573, 236, 513, 574, 251, 70, 303, 741, 926, 995, 527, 597, 446, 762, 440, 393, 38, 810, 107, 280, 845, 120, 56, 136, 765, 932, 192, 980, 113, 760, 758, 662, 265, 569, 284, 73, 97, 28, 251, 193, 548, 696, 46, 710, 881, 543, 91, 868, 755, 320, 665, 878, 540, 48, 103, 726, 237, 523, 226, 479, 125, 157, 827, 14, 81, 698, 403, 723, 536, 822, 846, 248, 691, 185, 712, 20, 166, 276, 441, 489, 15, 18, 700, 220, 688, 756, 904, 290, 694, 625, 721, 742, 972, 692, 975, 488, 6, 631, 997, 587, 501, 125, 957, 726, 616, 197, 45, 598, 97, 623, 838, 194, 722, 586, 59, 717, 431, 99, 309, 503, 913, 466, 524, 679, 166, 370, 219, 432, 968, 95, 736, 801, 542, 280, 615, 765, 132, 790, 50, 178, 461, 545, 297, 284, 43, 761, 183, 156, 50, 238, 776, 260, 154, 97, 110, 664, 265, 706, 440, 317, 701, 302, 355, 712, 165, 78, 150, 600, 631, 90, 296, 10, 72, 965, 420, 340, 235, 739, 111, 581, 656, 723, 27, 381, 275, 359, 705, 7, 340, 667, 510, 187, 396, 925, 58, 304, 419, 312, 317, 398, 353, 388, 720, 631, 571, 598, 390, 30, 808, 231, 177, 386, 239, 533, 701, 483, 452, 728, 817, 450, 144, 220, 448, 101, 354, 754, 410, 717, 531, 497, 624, 106, 40, 444, 663, 905, 751, 781, 947, 807, 621, 706, 205, 4, 708, 820, 690, 970, 460, 42, 403, 852, 578, 878, 161, 638, 760, 899, 389, 341, 754, 352, 423, 668, 858, 464, 392, 18, 651, 249, 401, 192, 90, 76, 579, 587, 347, 108, 612, 448, 108, 887, 259, 972, 393, 337, 655, 254, 384, 356, 868, 676, 652, 73, 725, 139, 517, 309, 479, 404, 844, 892, 614, 565, 783, 468, 454, 597, 249, 897, 876, 857, 347, 728, 760, 293, 20, 180, 506, 509, 467, 389, 15, 545, 819, 655, 398, 257, 112, 735, 557, 805, 757, 586, 853, 690, 485, 919, 127, 728, 86, 533, 486, 626, 37, 472, 384, 924, 576, 240, 490, 786, 216, 33, 73, 368, 175, 997, 598, 351, 535, 893, 6, 935, 326, 493, 474, 956, 184, 9, 878, 290, 957, 357, 408, 554, 7, 464, 414, 235, 189, 599, 404, 802, 472, 740, 304, 361, 487, 154, 229, 712, 985, 212, 775, 275, 960, 828, 279, 640, 572, 337, 683, 525, 365, 149, 25, 534, 291, 98, 953, 544, 620, 822, 972, 857, 921, 2, 847, 716, 132, 496, 895, 266, 749, 265, 364, 217, 895, 242, 932, 103, 979, 217, 226, 376, 889, 76, 684, 692, 297, 971, 59, 993, 981, 536, 735, 384, 189, 988, 975, 559, 746, 352, 167, 433, 958, 691, 911, 469, 176, 453, 243, 595, 943, 527, 421, 884, 503, 35, 113, 501, 89, 634, 823, 128, 638, 662, 439, 477, 160, 617, 787, 406, 208, 539, 692, 690, 663, 776, 653, 738, 77, 261, 839, 687, 751, 999, 320, 190, 876, 297, 255, 656, 245, 936, 864, 796, 466, 231, 935, 22, 61, 745, 984, 807, 321, 92, 937, 769, 665, 885, 227, 264, 506, 970, 407, 916, 311, 944, 486, 467, 243, 517, 296, 326, 145, 409, 648, 825, 754, 856, 114, 247, 285, 520, 472, 813, 62, 607, 96, 957, 289, 981, 887, 644, 617, 875, 448, 93, 104, 924, 412, 947, 845, 411, 688, 481, 916, 535, 114, 155, 156, 394, 935, 462, 892, 292, 475, 309, 318, 429, 417, 801, 314, 633, 223, 799, 973, 877, 46, 284, 45, 788, 257, 314, 292, 452, 879, 933, 729, 359, 538, 717, 441, 477, 953, 644, 693, 531, 707, 158, 71, 407, 268, 8, 960, 28, 765, 455, 704, 108, 74, 926, 273, 175, 606, 107, 283, 342, 618, 618, 295, 371, 473, 930, 812, 609, 561, 218, 321, 408, 943, 4, 979, 582, 546, 526, 45, 664, 890, 892, 419, 103, 451, 830, 958, 110, 142, 291, 924, 444, 556, 156, 580, 284, 737, 607, 199, 616, 699, 556, 9, 333, 186, 620, 825, 563, 817, 503, 449, 618, 913, 880, 106, 318, 601, 737, 573, 764, 626, 214, 804, 615, 153, 216, 521, 615, 612, 267, 871, 904, 644, 631, 87, 617, 150, 42, 571, 811, 714, 441, 43, 706, 500, 456, 122, 792, 632, 939, 235, 721, 787, 477, 761, 862, 672, 221, 69, 492, 322, 652, 244, 651, 380, 402, 449, 778, 67, 153, 766, 720, 95, 359, 184, 741, 751, 117, 669, 177, 681, 830, 405, 690, 650, 978, 416, 72, 750, 639, 428, 722, 423, 915, 165, 128, 299, 52, 285, 150, 237, 263, 634],       
    ]


    #> OPTION 2 (for multiple inputs)
    s = Solution()
    for i, case in enumerate(cases):
        # head = case
        head = build_linked_list(case)
        print(f"___ NO.{i} ___________________________________")
        # print("case: ", case)
        print(f"n={i} -> {s.insertGreatestCommonDivisors(head)}\n")

''' GENERATE MORE CASES:

    import random
    # Generate test cases
    cases = [
        [18, 6, 10, 3],           # Example case
        [7],                      # Single node
        [1000000, 999999, 2],     # Large values
        [1] * 10,                 # All ones
        [2, 4, 8, 16, 32],        # Powers of two
        [3, 6, 9, 12, 15],        # Multiples of three
        [random.randint(1, 1000000) for _ in range(10)],  # Random small case
        [random.randint(1, 1000000) for _ in range(10000)], # Maximum length case
    ]

    # Print cases in Python list format
    print("cases = [")
    for case in cases:
        print(f"    {case},")
    print("]")

    print("\nPlain list format:")
    for case in cases:
        print(case)

'''

# print("\nfindGreatestCommonDivisor _____________")
# print(Solution().findGreatestCommonDivisor(18,33))
# print("\ngetGreatestCommonDivisor ______________")
# print(Solution().getGreatestCommonDivisor(18,33))
# print("\nfindGCD ________________________________")
# print(Solution().findGCD(18,33))
# print("\ngcd ________________________________")
# print(Solution().gcd(18,33))